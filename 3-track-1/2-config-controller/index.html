<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.69.0" />
    <meta name="description" content="An Ansible Automation Platform 2 learning experience">
<meta name="author" content="GÃ¶tz, Christian">

    <link rel="icon" href="https://ansible-learnfest.github.io/images/favicon.png" type="image/png">

    <title>Configure Automation Controller :: Ansible LearnFest</title>

    
    <link href="https://ansible-learnfest.github.io/css/nucleus.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/fontawesome-all.min.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/hybrid.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/featherlight.min.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/perfect-scrollbar.min.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/auto-complete.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/atom-one-dark-reasonable.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/theme.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/tabs.css?1657702770" rel="stylesheet">
    <link href="https://ansible-learnfest.github.io/css/hugo-theme.css?1657702770" rel="stylesheet">
    
    <link href="https://ansible-learnfest.github.io/css/theme-red.css?1657702770" rel="stylesheet">
    
    

    <script src="https://ansible-learnfest.github.io/js/jquery-3.3.1.min.js?1657702770"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
  </head>
  <body class="" data-url="/3-track-1/2-config-controller/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://ansible-learnfest.github.io/">
    <img src="https://ansible-learnfest.github.io/images/aap-learnfest-logo.png">
  </a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="https://ansible-learnfest.github.io/js/lunr.min.js?1657702770"></script>
<script type="text/javascript" src="https://ansible-learnfest.github.io/js/auto-complete.js?1657702770"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/ansible-learnfest.github.io\/";
    
</script>
<script type="text/javascript" src="https://ansible-learnfest.github.io/js/search.js?1657702770"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='https://ansible-learnfest.github.io/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-intro/" title="Introduction" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/1-intro/">
          Introduction
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-getting-started/" title="Prepare Base Environment" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/2-getting-started/">
          Prepare Base Environment
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3-track-1/" title="Track 1: AAP Administrator" class="dd-item
        parent
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/">
          Track 1: AAP Administrator
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/1-automation-controller/" title="Install Automation Controller" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/1-automation-controller/">
          Install Automation Controller
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/2-config-controller/" title="Configure Automation Controller" class="dd-item
        
        active
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/2-config-controller/">
          Configure Automation Controller
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/3-install-pah/" title="Install Private Automation Hub" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/3-install-pah/">
          Install Private Automation Hub
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/4-use-pah/" title="Using Private Automation Hub" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/4-use-pah/">
          Using Private Automation Hub
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/5-automation-mesh/" title="Extend Automation Mesh" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/5-automation-mesh/">
          Extend Automation Mesh
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/6-aap2-fullstack/" title="AAP 2 Full Stack Installation" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/6-aap2-fullstack/">
          AAP 2 Full Stack Installation
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3-track-1/7-bonus-using-catalog/" title="Bonus Track: Automation Catalog" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/3-track-1/7-bonus-using-catalog/">
          Bonus Track: Automation Catalog
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/4-track-2/" title="Track 2: Automation Content Developer" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/4-track-2/">
          Track 2: Automation Content Developer
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/4-track-2/1-vscode/" title="The VSCode extension" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/4-track-2/1-vscode/">
          The VSCode extension
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-track-2/2-build-ee/" title="Build an execution environment" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/4-track-2/2-build-ee/">
          Build an execution environment
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-track-2/3-transfer-ee/" title="Transfer Execution Environment" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/4-track-2/3-transfer-ee/">
          Transfer Execution Environment
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/4-track-2/4-use-ee/" title="Using Private Automation Hub" class="dd-item
        
        
        
        ">
      <a href="https://ansible-learnfest.github.io/4-track-2/4-use-ee/">
          Using Private Automation Hub
          
      </a>
      
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://devsecops-workshop.github.io/"><i class='fas fa-home'></i> Homepage</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://ansible-learnfest.github.io/'></a> > <a href='https://ansible-learnfest.github.io/3-track-1/'>Track 1: AAP Administrator</a> > Configure Automation Controller
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#task-2-configure-automation-controller">Task 2: Configure Automation Controller</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Configure Automation Controller
            </h1>
          

        



	<h2 id="task-2-configure-automation-controller">Task 2: Configure Automation Controller</h2>
<p>Okay, Automation Controller is up and running but pretty empty. In this task you add some automation content to it. To make it not too easy and resemble more real life situations, you will use <strong>Ansible to configure Automation Controller objects</strong>.</p>
<p><strong>Prerequisites</strong></p>
<ul>
<li>Automation Controller is running &amp; accessible</li>
<li>You can run <code>ansible-navigator</code> on a laptop/VM.</li>
</ul>
<p><strong>Tasks</strong></p>
<ul>
<li>Create a Playbook using the <code>ansible.controller</code> collection to create these objects in your Automation Controller:
<ul>
<li><strong>Inventory</strong></li>
<li><strong>Hosts</strong> in the inventory, with your instance number 5 only</li>
<li><strong>Machine credentials</strong> to connect to your managed host</li>
<li><strong>Project</strong> to pull Ansible content from</li>
<li><strong>Template</strong> to install Apache on the managed hosts</li>
</ul>
</li>
<li>If you haven&rsquo;t done this before it might sound daunting, but fear not: You can find a complete template below in the <strong>Tips</strong> section.</li>
</ul>

<div class="notices tip" ><p>BTW you don&rsquo;t have to install the <code>ansible.controller</code> collection because it&rsquo;s already baked into the EE we used before to deploy instances.</p>
</div>

<p>Okay&hellip;</p>
<ul>
<li>On your system create a new directory next to the one with the cloned git repo from deploying the AWS instances.</li>
<li>In the new directory create a Playbook resembling the one from our lab.
<ul>
<li><strong>Note</strong>: We are using the supported collection <code>ansible.controller</code> here, upstream is called <code>awx.awx</code>.</li>
<li>Change the <code>loop</code> in the creating hosts section to only contain the public FQDN of your Controller instance.</li>
<li>Make sure <code>ssh_key_data:</code> points to the SSH key you use to connect to the instances</li>
</ul>
</li>
</ul>

<div class="notices tip" ><p>You have seen how <code>ansible-navigator</code> knew which Execution Environment image to use, right? But this only works if you have the needed configuration in <code>ansible-navigator.yml</code>living in the same directory you run <code>ansible-navigator</code> from. You can specify the EE and other parameters on the commandline but it&rsquo;s easier to track what you&rsquo;ve done in the config file. As a start <strong>copy the <code>ansible-navigator.yml</code> file over</strong> to your new directory and adapt it if needed.</p>
</div>

<ul>
<li>Configure credentials for the <code>ansible.controller</code> collection modules to be able to talk to your Automation Controller:
<ul>
<li>Set the environment variables <strong>CONTROLLER_HOST</strong>, <strong>CONTROLLER_USERNAME</strong>, <strong>CONTROLLER_PASSWORD</strong> with the values of your Automation Controller and set <strong>CONTROLLER_VERIFY_SSL=false</strong></li>
<li><strong>Important: Add the env vars above to the <code>ansible-navigator.yml</code> file</strong>
<ul>
<li>This way they are available in the running container!</li>
<li><strong>Add only the name of the variable under the env vars already in the file!</strong></li>
</ul>
</li>
</ul>
</li>
<li>Run the Playbook using <code>ansible-navigator</code>
<ul>
<li>Hint: Use <code>-m stdout</code> to mimic the output of <code>ansible-playbook</code></li>
</ul>
</li>
</ul>
<p><strong>Goal</strong></p>
<ul>
<li>The Playbook configured the objects needed</li>
<li>The <strong>Template</strong> run installed and started Apache on your managed node, should be instance 5</li>
<li>Opening the default webpage on the managed node in a browser works.</li>
</ul>
<p><strong>Tips</strong></p>
<ul>
<li>Here is the template for the Playbook:</li>
</ul>
<details><summary><b>Click here for Template</b></summary>
<hr/>
<p>
<pre><code>---
- name: Configure automation controller
  hosts: localhost
  become: false
  gather_facts: false
  tasks:
  - name: Create an inventory
    ansible.controller.inventory:
      name: Learnfest Inventory
      organization: Default
  - name: Add hosts to inventory
    ansible.controller.host:
      name: &quot;{{  item }}&quot;
      inventory: Learnfest Inventory
      state: present
    loop:
      - &lt;controller-host&gt;
  - name: Machine Credentials
    ansible.controller.credential:
      name: Learnfest Credentials
      credential_type: Machine
      organization: Default
      inputs:
        username: ec2-user
        ssh_key_data: &quot;{{ lookup('file', '~/.ssh/&lt;GUID&gt;key.pem' ) }}&quot;
  - name: Learnfest Project
    ansible.controller.project:
      name: Learnfest Project
      organization: Default
      state: present
      scm_update_on_launch: True
      scm_delete_on_update: True
      scm_type: git
      scm_url: https://github.com/ansible-learnfest/playbooks-example.git
  - name: Learnfest Job Template
    ansible.controller.job_template:
      name: Install Apache
      organization: Default
      state: present
      inventory: Learnfest Inventory
      become_enabled: True
      playbook: apache_install.yml
      project: Learnfest Project
      credential: Learnfest Credentials
</code></pre></p>
<hr/>
</details>
<ul>
<li>The collection/module documentation is here in <a href="https://console.redhat.com/ansible/automation-hub">Automation Hub</a>. Go to <strong>Collections</strong> and filter for <code>controller</code>.</li>
<li>If you would like to know what collections are in a certain Execution Environment, run <code>ansible-navigator collections</code> against the EE in question.</li>
<li>If you get confused by all the naming changes (<code>ansible.controller</code> in Automation Hub, <code>awx.awx</code> upstream, lot&rsquo;s of references to <code>Tower</code> in the docs)&hellip; don&rsquo;t be, all will finally be good! (TM)</li>
</ul>





<footer class=" footline" >
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="https://ansible-learnfest.github.io/3-track-1/1-automation-controller/" title="Install Automation Controller"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="https://ansible-learnfest.github.io/3-track-1/3-install-pah/" title="Install Private Automation Hub" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://ansible-learnfest.github.io/js/clipboard.min.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/perfect-scrollbar.min.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/perfect-scrollbar.jquery.min.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/jquery.sticky.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/featherlight.min.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/highlight.pack.js?1657702770"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://ansible-learnfest.github.io/js/modernizr.custom-3.6.0.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/learn.js?1657702770"></script>
    <script src="https://ansible-learnfest.github.io/js/hugo-learn.js?1657702770"></script>
    
        
            <script src="https://ansible-learnfest.github.io/mermaid/mermaid.js?1657702770"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>
